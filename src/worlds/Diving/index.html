<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts/>

    <script>
      AFRAME.registerComponent('attach-ui-to-camera', {
        schema: {},
        init: function () {
          const CONTEXT_AF  = this;
          const scene       = document.querySelector('a-scene');
          const uiElem      = document.querySelector('#custom_ui');

          //use a-frame camera event (when it is active)
          scene.addEventListener('camera-set-active', (e) => {
            e.detail.cameraEl.object3D.attach(uiElem.object3D);
            //to "unattach" or put UI back into scene
            //CONTEXT_AF.el.sceneEl.object3D.attach(uiElem.object3D);

        
          });
        }
      
      });


    </script>

    <!-- Physics script goes after the Circles' head scripts [IMPORTANT]-->
    <!-- <script src="/global/js/libs/aframe-physics-system.js"></script> -->
    <script src="/worlds/Diving/components/physics-object.js"></script>
    <script src="/worlds/Diving/components/collision-indicator.js"></script>
    <script src="/worlds/Diving/scripts/experiment-functions.js"></script>

    <script src="/worlds/Diving/scripts/timer.js"></script>
    <script src="/worlds/Diving/scripts/gameCode.js"></script>
    <script src="/worlds/Diving/scripts/shipwreck.js"></script>
    <script src="/worlds/Diving/scripts/safetystop.js"></script>
  </head>

  <body onload="setup()">
    <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui/>

       <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene circles_scene_properties physics="debug:false; gravity:-9.8;" background="color:#0476D9;" fog="type: linear; color: #0482d1; far: 30; near: 0">

      <!-- MUSIC -->
      
      <!-- <a-entity circles-sound="type:music; src:#music; autoplay:true; loop:true; volume:0.1;"></a-entity>
      <a-entity circles-sound="type:music; src:#waves; autoplay:true; loop:true; volume:0.4;"></a-entity> -->

      <a-camera position="0 1.4 3" rotation="-1 0 0"></a-camera>
      <!-- assets -->
      <a-assets timeout="10000">
        <!-- Images -->
        <img id="TableA_img" src="/worlds\Diving\assets\images/TableA.png" crossorigin="anonymous">
        <img id="TableBCD_img" src="/worlds\Diving\assets\images/TableBCD.png" crossorigin="anonymous">

        <!-- GLTF Models -->
        <a-asset-item id="Profile1-gltf" src="/worlds/Diving/assets/models/experimentObjects/DiveProfile1.glb"></a-asset-item>
        <a-asset-item id="Profile2-gltf" src="/worlds/Diving/assets/models/experimentObjects/DiveProfile2.glb"></a-asset-item>
        <a-asset-item id="Profile3-gltf" src="/worlds/Diving/assets/models/experimentObjects/DiveProfile3.glb"></a-asset-item>
        <a-asset-item id="Profile4-gltf" src="/worlds/Diving/assets/models/experimentObjects/DiveProfile4.glb"></a-asset-item>
    
        <a-asset-item id="DiveBoat-gltf" src="/worlds/Diving/assets/models/DiveBoat.glb"></a-asset-item>
        <a-asset-item id="OceanFloor-gltf" src="/worlds/Diving/assets/models/OceanFloor.glb"></a-asset-item>
        <a-asset-item id="Shipwreck-gltf" src="/worlds/Diving/assets/models/Shipwreck.glb"></a-asset-item>
        <a-asset-item id="Hills-gltf" src="/worlds/Diving/assets/models/Hills.glb"></a-asset-item>
        <a-asset-item id="Rocks-gltf" src="/worlds/Diving/assets/models/Rocks.glb"></a-asset-item>
        <a-asset-item id="CoralReef-gltf" src="/worlds/Diving/assets/models/CoralReef.glb"></a-asset-item>
        <a-asset-item id="Coral-gltf" src="/worlds/Diving/assets/models/Coral.glb"></a-asset-item>
        <a-asset-item id="Orca-gltf" src="/worlds/Diving/assets/models/Orca.glb"></a-asset-item>

        <!-- <audio id="divesfx" src="/worlds/Diving/assets/minecraftsfx.mp3" preload="auto"></audio>
        <audio id="music" src="/worlds/Diving/assets/Axolotl.mp3" preload="auto"></audio>
        <audio id="appclick" src="/worlds/Diving/assets/appbutton.mp3" preload="auto"></audio>
        <audio id="menuclick" src="/worlds/Diving/assets/menuclick.mp3" preload="auto"></audio>
        <audio id="waves" src="/worlds/Diving/assets/moonbeach.mp3" preload="auto"></audio> -->

        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets/>
      </a-assets>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar/>

      <!-- 
      -->
      <a-entity id="Boat_GRP" position="0 24.668 10.372">
        <a-entity id="DiveBoat" position="0 -1.7 -8.8" scale="0.01 0.01 0.01" rotation="0 90 0" gltf-model="#DiveBoat-gltf"></a-entity>
      
        
      <!-- Experiment Objects -->
      <a-entity gltf-model="#Profile1-gltf" id="rightObject" physics-object="initialPosition: 0 1.9 -10.196; mass: 0.43;" scale="0.6 0.6 0.6" rotation="0 0 90"></a-entity>

      <!-- Control station -->
      <a-entity id="controlStation" geometry="primitive: box; width:5.5; height: 3; depth: 0.15" material="color: #035AF7;" position="0 0.68 -10.5" rotation="-30 180 0" scale="0.4 0.4 0.4">
        <a-entity id="controlStationButtons" rotation="90 0 0">
          <!-- Experiment control buttons -->
          <a-entity id="startButtonGroup" position="0.7 0.1 0.9" scale="1.5 1.5 1.5">
            <a-entity id="startButton" onclick="startExperiment()" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <a-entity id="startText" text="value: SELECT; color: white; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="2.2 2.2 2.2" position="0 0 -0.45" rotation="-90 0 0"></a-entity>
          </a-entity>

          <a-entity id="resetButtonGroup" position="-0.7 0.1 0.9" scale="1.5 1.5 1.5">
            <a-entity id="resetButton" onclick="resetExperiment()" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <a-entity id="resetText" text="value: RESET; color: white; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="2.2 2.2 2.2" position="0 0 -0.45" rotation="-90 0 0"></a-entity>
          </a-entity>

          <!-- Dive profile selection buttons -->
          <a-entity id="rightObject1ButtonGroup" position="-2.3 0.1 -0.9">
            <a-entity id="rightObject1Button" onclick="setNewObject('object1', 'right')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)" ></a-entity>
            <a-entity id="rightObject1Text" text="value: Dive Profile 1; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="1.5 1.5 1.5" position="1.0 0 0.0" rotation="-90 0 0"></a-entity>
          </a-entity>

          <a-entity id="rightObject2ButtonGroup" position="-2.3 0.1 0">
            <a-entity id="rightObject2Button" onclick="setNewObject('object2', 'right')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)" ></a-entity>
            <a-entity id="rightObject2Text" text="value: Dive Profile 2; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="1.5 1.5 1.5" position="1.0 0 0.0" rotation="-90 0 0"></a-entity>
          </a-entity>

          <a-entity id="leftObject1ButtonGroup" position="2.3 0.1 -0.9">
            <a-entity id="leftObject1Button" onclick="setNewObject('object3', 'right')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)"></a-entity>
            <a-entity id="leftObject1Text" text="value: Dive Profile 3; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="1.5 1.5 1.5" position="-1.0 0 0.0" rotation="-90 0 0"></a-entity>
          </a-entity>

          <a-entity id="leftObject2ButtonGroup" position="2.3 0.1 0">
            <a-entity id="leftObject2Button" onclick="setNewObject('object4', 'right')" circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)" ></a-entity>
            <a-entity id="leftObject2Text" text="value: Dive Profile 4; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="1.5 1.5 1.5" position="-1.0 0 0.0" rotation="-90 0 0"></a-entity>
          </a-entity>

        </a-entity>

        <a-entity id="controlStationUI" position="0 0 0.1" rotation="90 0 0">
          <!-- Control panel label -->
          <a-entity class="controlLabel" position="0 -0.2 -0.75" rotation="90 90 -90" scale="7 7 7" text="value:Control; color: #025d96; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43;  negate: false; lineHeight: 60"></a-entity>
          <a-entity class="panelLabel" position="0 -0.2 0.2" rotation="90 90 -90" scale="7 7 7" text="value:Panel; color: #025d96; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43;  negate: false; lineHeight: 60"></a-entity>

        </a-entity>
      </a-entity>

      <!-- Experiment indicators -->
      <a-entity id="leftCollisionIndicator" collision-indicator position="-0.6 0.3 -5.5" scale="0.5 0.5 0.5"></a-entity>
      <a-entity id="rightCollisionIndicator" collision-indicator position="0.6 0.3 -5.5" scale="0.5 0.5 0.5"></a-entity>
      <!-- Judy replaced this with the above line:        <a-entity id="rightCollisionIndicator" collision-indicator position="0.6 1.6 -0.5" scale="0.5 0.5 0.5"></a-entity>   -->
      <!-- Floor -->
      <!-- We use a box and not a plane because the hitbox of the plane is not 100% tight around it. This caused an issue where the objects would not hit the floor, but rather would just float. -->
      <!-- 
      <a-box position="0 -0.5 -5" height="1" width="30" depth="30" rotation="0 0 0" color="#047cc7" static-body="shape: plane;" circles-shadow></a-box>
       -->

      <!-- Checkpoints -->
      <a-entity circles-checkpoint id="check1" position="0 0.05 0"></a-entity>
      <a-entity circles-checkpoint id="check1" position="-3.5 0.05 -1.7"></a-entity>
      <a-entity circles-checkpoint id="check1" position="3.5 0.05 -1.7"></a-entity>
      <a-entity circles-checkpoint id="check1"  position="-2.8 0.05 -10"></a-entity>
      <a-entity circles-checkpoint id="check1"  position="-0.060 0.130 -11.943"></a-entity>
      <a-entity circles-checkpoint id="check1"  circles-spawnpoint position="-0.060 24.662 -2.317"></a-entity>

    </a-entity>

      <!-- shipwreck Checkpoints -->
      <a-entity  circles-checkpoint="" id="checklower-1" position="18 -20 -39"></a-entity>
      <a-entity checkpointclick="" circles-checkpoint="" id="checklower-2" position="20.95694 -23.87344 -45.61645" ></a-entity>
      <a-entity checkpointclick="" circles-checkpoint="" id="checklower-3" position="19.40414 -24.73647 -50.93122" class="checkpoint interactive" ></a-entity>
      <a-entity checkpointclick="" circles-checkpoint="" id="checklower-4" position="6.62861 -30.5131 -75.26348" ></a-entity>

      
       <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~    END BOAT GROUP ~~~~~~~~~~~ -->
      </a-entity>
      
      
      <a-entity id="Ocean_grp" position="0 -14.287 67.716 " rotation="-6.549 0 0">
        <a-entity id="OceanFloor" position="0 -1.7 -8.8" scale="1 1 1" rotation="0 90 0" gltf-model="#OceanFloor-gltf"></a-entity>
        <a-entity id="Shipwreck" position="0 -1.7 -8.8" scale="1 1 1" rotation="0 90 0" gltf-model="#Shipwreck-gltf"></a-entity>
        <a-entity id="Hills" position="0 -1.7 -8.8" scale="1 1 1" rotation="0 90 0" gltf-model="#Hills-gltf"></a-entity>
        <a-entity id="Rocks" position="0 -1.7 -8.8" scale="1 1 1" rotation="0 90 0" gltf-model="#Rocks-gltf"></a-entity>
        <a-entity id="CoralReef" position="0 -1.7 -8.8" scale="1 1 1" rotation="0 90 0" gltf-model="#CoralReef-gltf"></a-entity>
        <a-entity id="Coral" position="0 -1.7 -8.8" scale="1 1 1" rotation="0 90 0" gltf-model="#Coral-gltf"></a-entity>
        <a-entity id="Orca" position="0 -1.7 -8.8" scale="1 1 1" rotation="0 90 0" gltf-model="#Orca-gltf" animation-mixer></a-entity>
      </a-entity>


      <a-entity light="type:ambient; color:#FFF; intensity:3.0"></a-entity>
      <a-entity light="type: directional; color: #FFF; intensity: 1.0" position="0 1 1"></a-entity>

     

      <!-- BUTTON UP AND DOWN UI 
      animation__mouseleave__2="property:position; to:-0.65 1.6 -0.5; startEvents:mouseleave; dur:200">
     animation__mouseenter__2="property:position; to:0.023 1.6 -0.483; startEvents:mouseenter; dur:200"
    
      
      -->
    
      <a-entity id="custom_ui" position="0.71901 1.28191 -0.59158" scale="0.20618 0.17248 0.17248" attach-ui-to-camera="">
        <a-entity id="table_ui" attach-ui-to-camera scale="2 2 2" position="-3.46 -1.46 2.75">
          <a-entity id="divetable_button" divetable position="-0.624 1.6 -1"  
                            class="button interactive" 
                            geometry="primitive:plane; width:0.136; height:0.25;"
                            material="src:#TableA_img;"

                            animation__mouseenter="property:scale; to:7 7 7; startEvents:mouseenter; dur:200"
                            

                            animation__mouseleave="property:scale; to:1.0 1.0 1.0; startEvents:mouseleave; dur:200"
                            
                        >

                        
                          </a-entity>
                        </a-entity>
        <a-entity timer id="start_dive" visible="false" class="button interactive" geometry="primitive: triangle" position="-3.685 0 0" material="color: blue" animation__mouseenter="property: scale; to: 0.9 0.9 0.9; startEvents: mouseenter; dur: 200" animation__mouseleave="property: scale; to: 0.8 0.8 0.8; startEvents: mouseleave; dur: 200"  rotation="0 0 180"></a-entity>
        
        <a-entity timer id="down_button" visible="false" class="button" geometry="primitive: triangle" material="color: red" position = "-2.131 0 0" animation__mouseenter="property: scale; to: 0.9 0.9 0.9; startEvents: mouseenter; dur: 200" animation__mouseleave="property: scale; to: 0.8 0.8 0.8; startEvents: mouseleave; dur: 200"  rotation="0 0 180" ></a-entity>
        <a-entity timer="" id="up_button" visible="false" class="button" geometry="primitive: triangle" material="color: white" animation__mouseenter="property: scale; to: 0.8 0.8 0.8; startEvents: mouseenter; dur: 200" animation__mouseleave="property: scale; to: 0.7 0.7 0.7; startEvents: mouseleave; dur: 200" position="-4.849 0.2 0.221" rotation="" scale="0.7 0.7 0.7" ></a-entity>
        <a-entity timer="" id="end_button" visible="false" class="button interactive" geometry="primitive: triangle" material="color: yellow" animation__mouseenter="property: scale; to: 0.8 0.8 0.8; startEvents: mouseenter; dur: 200" animation__mouseleave="property: scale; to: 0.7 0.7 0.7; startEvents: mouseleave; dur: 200" position="-4.849 0.2 0.221" rotation="" scale="0.7 0.7 0.7"></a-entity>
        <a-entity attach-ui-to-camera="" visible="false" safetyclick="" id="safety-check" circles-interactive-object="" class="button interactive" geometry="primitive: circle" material="color: green" animation__mouseenter="property: scale; to: 0.3 0.25 0.3; startEvents: mouseenter; dur: 200" animation__mouseleave="property: scale; to: 0.25 0.2 0.25; startEvents: mouseleave; dur: 200" position="-2.63659 1.35127 1.10889" rotation="" scale="0.25 0.2 0.25" circles-material-extend-fresnel="fresnelOpacity: 0; fresnelPow: 2" sound="volume: 0.5" animation__highlightanim="property: circles-material-extend-fresnel.fresnelOpacity; to: 0; dur: 100"></a-entity>
         <a-entity attach-ui-to-camera="" id="safety-text" text="value: Safety Check; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="0.5 0.5 0.5"  position="-2.63659 1.35127 1.10889" rotation="" visible="false"></a-entity>

        <a-entity attach-ui-to-camera="" id="Time Title" text="value: Timer:; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-4.2 3.6 0.73" rotation="" visible=""></a-entity>
        <a-entity attach-ui-to-camera="" id="start_text" text="value: click here to start dive; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-3.47283 0.71217 0.18593" rotation="" visible="false"></a-entity>
          <a-entity  attach-ui-to-camera="" id="timer" text="value: 0; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font:sourcecodepro; negate: false; lineHeight: 60" scale="1.5 1.5 1.5" position="-3.16 4 0.09" rotation="" visible="" timer=""></a-entity>
        

      <!-- END SCREEN -->
      <a-entity id="end-texts-grp" visible="false"> 
      <a-entity attach-ui-to-camera="" id="End title" text="value: Congrats! You have completed the dive.; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-3.356 3.013 0.73" rotation="" visible=""></a-entity>
      <a-entity attach-ui-to-camera="" id="End title-2" text="value: Review; color: #388eff; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-3.356 2.533 0.73" rotation="" visible=""></a-entity>
      <a-entity attach-ui-to-camera="" id="dive profile" text="value: Dive Profile:; color: #fff838; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-4.896 2.273 0.73" rotation="" visible=""></a-entity>
      <a-entity attach-ui-to-camera="" id="diveprofile_result" text="value: __________; color: #ffffff; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-4.016 2.273 0.73" rotation="" visible=""></a-entity>
      <a-entity attach-ui-to-camera="" id="diveprofile_desc" text="value: This is the description for the profile; color: blue; width: 2; wrapCount: 40.000; align: center; tabSize: 10; font: sourcecodepro; negate: false; lineHeight: 60; alphaTest: 1" scale="" position="-3.356 1.943 0.73" rotation="" visible=""></a-entity>
      <a-entity attach-ui-to-camera="" id="donesafety" text="value: Safety Stop:; color: #fff838; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-4.976 1.443 0.73" rotation="" visible=""></a-entity>
      <a-entity attach-ui-to-camera="" id="donesafety_response" text="value: No; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-4 1.443 0.73" rotation="" visible=""></a-entity>
      <a-entity attach-ui-to-camera="" id="100ft_title" text="value: Reached 100ft:; color: #fff838; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-4.976 0.9 0.73" rotation="" visible=""></a-entity>
      <a-entity attach-ui-to-camera="" id="100ft_desc" text="value: No; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="" position="-4 0.9 0.73" rotation="" visible=""></a-entity>
     
    </a-entity>


    <a-entity attach-ui-to-camera="" id="end_text" text="value: Click up to end the dive; color: white; width: 2; wrapCount: 30; align: center; tabSize: 4.43; font: sourcecodepro; negate: false; lineHeight: 60" scale="0.4 0.4 0.4" position="-3.48731 1.14126 1.8635" rotation="" visible="false"></a-entity>
    <a-entity timer="" id="end_bg" visible="false" geometry="primitive: plane" material="color: black; opacity: 0.9" position="-3.41324 1.65556 0.22084" rotation="" scale="5.18042 3.86279 0.8"></a-entity>
            
      
      
      <!-- END ARROW UI-->    
                </a-entity>


      </a-entity>

    </a-scene>
                        <!-- animation__mouseenter="property:position.x; to:0.0; property:scale; to:3.0 3.0 3.0; startEvents:mouseenter; dur:200" 
                                                animation__click="property:rotation.y; from:0.0; to:360.0; startEvents:click; dur:300"></a-entity>
                        -->
    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts/>
  </body>
</html>

