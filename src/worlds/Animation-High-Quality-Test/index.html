<html>

  <head>

    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts/>

    <script src="/worlds/Animation-High-Quality-Test/phones/phone-animation-list.js"></script>

    <script src="/worlds/Animation-High-Quality-Test/scripts/facial-animator.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/scripts/audio-listener.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/scripts/ai-agent.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/scripts/QUEUE-facial-animator.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/scripts/QUEUE-ai-agent.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/scripts/QUEUE2-ai-agent.js"></script>

    <script src="https://rawcdn.githack.com/elbobo/aframe-gltf-morph-component/07e9b80bd382cc1c19223468d35c453e7c76e9a2/dist/aframe-gltf-morph-component.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/document-register-element/0.5.3/document-register-element.js"></script>

    <script src="/worlds/Animation-High-Quality-Test/animations/animated-eyes.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/animations/animated-brows.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/animations/animated-cheeks.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/animations/animated-nose.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/animations/animated-mouth.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/animations/animated-jaw.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/animations/animated-tongue.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/animations/animated-face.js"></script>
    <script src="/worlds/Animation-High-Quality-Test/animations/animated-visemes.js"></script>

    <!-- <script src="/worlds/Animation-High-Quality-Test/scripts/gui.js" type="module"></script> -->

    <script src="/worlds/Animation-High-Quality-Test/scripts/morph-targets.js"></script>

  </head>

  <body>
    
    <!-- 2D UI elements overylayed on the 3D scene for user options -->
    <circles-basic-ui/>
    
    <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui/>

    <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene circles_scene_properties circles-model-manager stats>
      
      <a-assets>
        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets/>
      </a-assets>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar/>

      <a-entity id="agent-model" circles-model="/worlds/Animation-High-Quality-Test/assets/character/model.fbx"></a-entity>

      <a-entity id="agent"
                class="animated"
                circles-model-display="agent-model"
                position="-0.15 0 -0.5"
                rotation="0 20 0"
                scale="0.01 0.01 0.01"
                animated-face
                circles-audio-listener
                queue2-circles-ai-agent
                queue-circles-facial-animator>
    </a-entity>

    <a-entity id="animation-button"
                geometry="primitive:box"
                material="color:grey"
                position="0.75 0.4 -1.25"
                scale="0.5 0.8 0.5">

        <a-entity circles-button="target:#animation-button; click_on_event:start; click_off_event:stop"
                  position="0 0.5 0">
        </a-entity>

      </a-entity>
      
    </a-scene>

    <script>

      document.getElementById('animation-button').addEventListener('start', function()
      {
        //document.getElementById('agent').emit('response-ready', {audioClip: '/worlds/Allosaurus-Test/audio/sample.wav'});
        //document.getElementById('agent').emit('start-listening');
        document.getElementById('agent').components['queue2-circles-ai-agent'].processInput('Hello. How are you?');
      });

      document.getElementById('animation-button').addEventListener('stop', function()
      {
        //document.getElementById('agent').emit('stop-listening');
        document.getElementById('agent').components['queue2-circles-ai-agent'].processInput('Hello. How are you?');
      });

    </script>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts/>

  </body>

</html>