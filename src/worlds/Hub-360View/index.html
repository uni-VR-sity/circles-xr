<html>
<head>
  <!-- Circles' head scripts [REQUIRED] -->
  <circles-start-scripts/>

  <!-- imersive video component -->
  <script src="https://unpkg.com/aframe-immersive-video-component/dist/aframe-immersive-video-component.min.js"></script>
  
  <!-- video UI -->
  <script src="scripts/play-pause.js"></script>
  <script src="scripts/video-bar.js"></script>
  <script src="scripts/video3d-swap.js"></script>
  <script src="scripts/video-skip.js"></script>

  <!-- rock stacking code (taking this out for now)
  <script src="scripts/rock-marker.js"></script>
  -->

  <script src="scripts/teleport-click.js"></script>

</head>
<body>
  <!-- 2D UI elements overylayed on the 3D scene for user options -->
  <circles-basic-ui/>
  
  <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
  <circles-start-ui/>

  <!-- a-scene with 'circles-properties' component [REQUIRED] -->
  <a-scene circles_scene_properties background="color: #c3f2f7" circles-model-manager>
    <a-assets>

      <!-- Circles' built-in assets [REQUIRED] -->
      <circles-assets/>

      <!-- 360 -->
      <img id='link_1_360'        src='/global/images/WIT_1_Screen.jpg' crossorigin="anonymous">
      
      <!-- 360 video -->
      <!-- video link https://www.storyblocks.com/video/stock/waterfall-in-green-rainforest-360vr-tropical-tuasan-falls-in-mountain-jungle-waterfall-in-the-tropical-forest-camiguin-philippines-mindanao-347542865 -->
      <video id="video3D" src="assets/videos/boatTest_short_360.mp4" autoplay="false" loop="false" crossorigin="anonymous"></video>
      <video id="video3D_2" src="assets/videos/TruckDrive_360_cliped_1.mp4" autoplay="false" loop="false" crossorigin="anonymous"></video>
      <!-- audio link https://pixabay.com/sound-effects/waterfall-24060/ -->
      <!-- NOTE: we might want to make an array of environtmetn sounds so we can add more easily and stop them all at once when we pasue 
      <audio id="video3D_snd" src="assets/audio/waterfall-24060.mp3" autoplay loop="true" crossorigin="anonymous"></audio>
      -->

      <!-- play / pause button -->
      <img id="play" src="assets/images/play-button.png" crossorigin="anonymous">
      <img id="pause" src="assets/images/pause-button.png" crossorigin="anonymous">
      <audio id="toggle_snd" src="assets/audio/item_selected.mp3" preload="auto" crossorigin="anonymous"></audio>

      <!-- Ground texture -->
      <img id="ground_txr" src="assets/textures/top-view-corn-flour-texture.jpg" crossorigin="anonymous">

      
    </a-assets>

    <!-- Circles' built-in manager and avatar [REQUIRED] -->
    <circles-manager-avatar/>

    <!-- start your code: put your A-frame, Circles XR, and custom components here -->

    <!-- links to other worlds -->
    <a-entity id="link_1"
      position="-0.559 1.7 4.134" rotation="0 56.215 0" scale="0.5 0.5 0.5"
      circles-portal="img_src:#link_1_360; title_text:Campfire Hub; link_url:/w/Campfire-Hub;"
      shadow></a-entity>

    <a-entity id="mountain" circles-model="/worlds/Hub-360View/assets/models/mountain/source/Rockn/Mou.fbx"></a-entity>
    
    <!--
    <a-entity circles-model-display="mountain"
              scale="0.05 0.05 0.05"
              position="-20.42576 -4.6 -3.55064"
              circles-interactive-object
              teleport-click>
    </a-entity>
    -->

    <a-entity id="floor"
      rotation="-90 0 0" scale="1 1 1"
      geometry="primitive: plane; height: 10; width: 10" 
      material="shader: flat; color: #aa9999; src: #ground_txr"
      circles-interactive-object
      rock-marker
      teleport-click></a-entity>

      <!-- add the video sphere -->
      <a-videosphere  id="video3D_main" 
                      src="#video3D"></a-videosphere>

      <!-- Black sphere for a fade transition -->
      <a-entity id="fadeSphere"
                geometry="primitive: sphere; radius: 400;"
                material="color: #000000; opacity: 0; shader: flat; side: back;"
                ></a-entity>

      <!-- mini video spheres; when you click on them they become the large video around you 
      <a-videosphere  src="#video3D"
                      position="-4 1 -3"
                      scale="0.001 0.001 0.001"
                      circles-interactive-object
                      video3d-swap
                      ></a-videosphere>
      <a-videosphere  src="#video3D_1"
                      position="-3 1 -3"
                      scale="0.001 0.001 0.001"
                      circles-interactive-object
                      video3d-swap
                      ></a-videosphere>
      <a-videosphere  src="#video3D_2"
                      position="-2 1 -3"
                      scale="0.001 0.001 0.001"
                      circles-interactive-object
                      video3d-swap
                      ></a-videosphere>
      -->

      <!-- add the play button in the scene to play and puase the video --> 
      <a-image  id="videoControls" 
                src="#play" 
                position="0 1 -2"
                play-pause
                circles-interactive-object="type:scale; click_sound:#toggle_snd"></a-image>
      
      <!-- full lenght of video -->
      
      <a-entity id="videoBar"
                geometry="primitive:plane"
                position="0 0.37862 -2"
                scale="2 0.08 0"
                material="color:#888888"></a-entity>
      
      <!-- current video time -->
      <a-entity id="videoProgressBar"
                geometry="primitive:plane"
                position="0 0.37862 -1.98"
                scale="0 0.08 0"
                material="color:#FF0000"
                video-bar="video_length:52; video_bl: 2.0; video_blc: 0.0;">
      </a-entity>

      <!-- Skip button -->
      <a-entity id="skipButton" 
                geometry="primitive: cylinder" 
                position="0 0 -1" 
                scale="0.2 0.2 0.2"
                material="color:#00FF00"
                video-skip
                circles-interactive-object="type:outline; click_sound:#toggle_snd">
      </a-entity>

    <!-- end your code: -->
  </a-scene>

  <!-- Circles' end scripts [REQUIRED] -->
  <circles-end-scripts/>
 </body>
</html>