<html>
  <head>
    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts/>

    <script src="https://rawcdn.githack.com/elbobo/aframe-gltf-morph-component/07e9b80bd382cc1c19223468d35c453e7c76e9a2/dist/aframe-gltf-morph-component.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/document-register-element/0.5.3/document-register-element.js"></script>

    <script src="/worlds/Facial-Animation-test/components/animated-eyes.js"></script>
    <script src="/worlds/Facial-Animation-test/components/animated-brows.js"></script>
    <script src="/worlds/Facial-Animation-test/components/animated-cheeks.js"></script>
    <script src="/worlds/Facial-Animation-test/components/animated-nose.js"></script>
    <script src="/worlds/Facial-Animation-test/components/animated-mouth.js"></script>
    <script src="/worlds/Facial-Animation-test/components/animated-jaw.js"></script>
    <script src="/worlds/Facial-Animation-test/components/animated-tongue.js"></script>
    <script src="/worlds/Facial-Animation-test/components/animated-face.js"></script>
    <script src="/worlds/Facial-Animation-test/scripts/gui.js" type="module"></script>
  </head>
  <body>

    <!-- 2D UI elements overylayed on the 3D scene for user options -->
    <circles-basic-ui/>

    <!-- This is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui/>

    <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene id="scene" circles_scene_properties>
      <a-assets>
        <!-- Models used in the scene -->
        <a-asset-item id="faceLowpoly-glb" src="/worlds/Facial-Animation-test/assets/BaseFace_morph_test_10.glb"></a-asset-item>
        <a-asset-item id="faceHighpoly-glb" src="/worlds/Facial-Animation-test/assets/BaseFace_morph_testHighpoly_01.glb"></a-asset-item>

        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets/>
      </a-assets>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar/>

      <!-- CIRCLE GENERATION STARTS HERE -->

      <a-entity id="baseFace" class="animated" position="0 1.5 -5" rotation="0 180 0"
              gltf-model="#faceLowpoly-glb" animated-face></a-entity>

      <a-box position="0 0.5 -1" width="0.3" height="1" depth="0.3" 
            static-body shadow="receive:true; cast:true;">
            <a-entity id="blinkButton" onclick="document.getElementById('baseFace').emit('moveEyes', {value: 'neutralize'}); document.getElementById('baseFace').emit('moveMouth', {value: 'neutralize'}); document.getElementById('baseFace').setAttribute('animated-face', { state: 'null' });" position="0 0.5 0" scale="0.5 0.5 0.5"
                      circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)">
            </a-entity>
      </a-box>

      <a-box position="1 0.5 -1" width="0.3" height="1" depth="0.3" 
            static-body shadow="receive:true; cast:true;">
            <a-entity id="squintButton" onclick="document.getElementById('baseFace').emit('moveEyes', {value: 'scared', side: 'both', dur: 3}); document.getElementById('baseFace').emit('moveMouth', {value: 'scaredOpen', side: 'both', dur: 3});" position="0 0.5 0" scale="0.5 0.5 0.5"
                      circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)">
            </a-entity>
      </a-box>

      <!-- QUESTION: why do we have 2 squintButtons? I think this is supposed to be the "idleButton" and the button before is the "scaredButton" ^ -->
      <a-box position="-1 0.5 -1" width="0.3" height="1" depth="0.3" 
            static-body shadow="receive:true; cast:true;">
            <a-entity id="squintButton" onclick="document.getElementById('baseFace').setAttribute('animated-face', { state: 'idle' });" position="0 0.5 0" scale="0.5 0.5 0.5"
                      circles-button="button_color: rgb(101,199,93); button_color_hover: rgb(66,133,61)">
            </a-entity>
      </a-box>

      <!-- checkpoints -->
      <a-entity>
        <a-entity id="spawnPoint" circles-checkpoint circles-spawnpoint position="0 0.05 0"></a-entity>
      </a-entity>

    </a-scene>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts/>
  </body>
</html>